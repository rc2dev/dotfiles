# Startup commands for dwm
#
# Author: Rafael Cavalcanti <https://rafaelc.org/dev>

xrdb $XRESOURCES

# Make Qt applications to be styled as Gtk
# (needes QGnomePlatform, installed by default on Fedora)
export QT_QPA_PLATFORMTHEME=gnome

lxpolkit &  # Polkit agent, so GUI applications can request privileges
xsettingsd &
remap-kb &
sxhkd &
gen-dunst-theme &  # This already calls dunst
nitrogen --restore &
/usr/libexec/geoclue-2.0/demos/agent &  # Needed for redshift on Fedora WM
redshift-gtk &
picom &
clipmenud &
nm-applet &
system-config-printer-applet &
keepassxc &
$TERMINAL -n plan -e notes today &

# rd specific
if [ "$HOST" = "rd" ]; then
  # If -f is not passed, mouse over dwmbar has the same behaviour
  # as it was over the focused window.
  imwheel -b "4 5" -f &

  # Automatically lock and suspend after idle
  xidlehook \
    --detect-sleep \
    --not-when-fullscreen \
    --not-when-audio \
    --socket "$XIDLEHOOK_SOCK" \
    --timer 120 'slock' '' \
    --timer 900 'systemctl suspend' '' \
    &

  kdeconnect-indicator &
fi

# Statusbar loop
while true; do
  dwmbar
  sleep 10s
done &

