#!/usr/bin/env bash
#
# dmenu script for opening documents
#
# Author: Rafael Cavalcanti <https://rafaelc.org/dev>

set -euo pipefail
readonly dmenu="${DMENU:-dmenu}"
readonly prompt="Open"

fd \
  --follow \
  --exclude "backups" --exclude "Cursos/" --exclude "Notes/" \
  . ~/Documents ~/Downloads "$NOTES"/resources ~/Sync ~/Videos |
  sed "s|$HOME|\~|" |
  sort |
  $dmenu -p "$prompt" |
  sed "s|~|$HOME|" |
  xargs -r -d'\n' -P 0 -n 1 xdg-open
